# Prosodic Deepfake Detection

Исследование выявляет акустические различия между натуральной и синтетической речью через анализ интонационно-ритмических признаков (OpenSMILE) с применением машинного обучения (Random Forest) на парной выборке аудиозаписей.

[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/drive/1dH3dSLccJq_5KW9NbHk2V1drAFq8NzQW?usp=sharing)

---

## Содержание

- [Описание](#описание)
- [Структура проекта](#структура-проекта)
- [Данные](#данные)
- [Методология](#методология)
- [Результаты](#результаты)
- [Установка и запуск](#установка-и-запуск)
- [Технологии](#технологии)

---

## Описание

Проект посвящен детекции синтетической речи (дипфейков) на основе просодических признаков. Исследование включает четыре основных части:

1. **Анализ одиночных признаков** — оценка различительной способности 13 акустических параметров
2. **Инверсионный эксперимент** — коррекция направления классификации для слабых признаков
3. **Комбинированная модель** — создание Random Forest классификатора
4. **Сравнение TTS-систем** — анализ различий между FastPitch и VITS

---

## Данные

### Исходная выборка (Части 1-3)
- **Объем**: 872 аудиофайла
  - 436 натуральных записей
  - 436 синтетических записей
- **Формат**: WAV, парные записи одного текста

### Расширенная выборка (Часть 4)
- **Объем**: 1428 аудиофайлов
  - 476 натуральных (Real)
  - 476 FastPitch-HiFiGAN
  - 476 VITS
- **Формат**: WAV, триплеты (3 версии каждой фразы)

---

## Методология

### Часть 1: Извлечение признаков (OpenSMILE)

**Инструмент**: OpenSMILE eGeMAPSv02 (88 параметров)

**Ключевые признаки** (13 отобранных):
- **Высота голоса (F0)**: средняя, изменчивость, скорость изменения интонации
- **Громкость**: средняя, изменчивость, затухание
- **Ритмика**: длительность пауз/произнесения, количество фрагментов, акцентов
- **Спектр**: скорость изменения

**Метрика**: Equal Error Rate (EER) — процент ошибок при равной вероятности ложного принятия и отклонения

### Часть 2: Инверсионный эксперимент

**Проблема**: 7 из 13 признаков имели EER > 50% (хуже случайного угадывания)

**Решение**: Инверсия предсказаний (умножение скоров на -1)

**Результат**: 
- Все 7 признаков улучшились
- Средний EER снизился с 49.2% до 46.3%
- Обнаружено, что некоторые признаки работают в противоположном интуитивному направлении

### Часть 3: Комбинированная модель (Random Forest)

**Архитектура**:
```python
RandomForestClassifier(
    n_estimators=100,
    max_depth=10,
    min_samples_split=5,
    random_state=42
)

**Входные признаки** (топ-5 по EER):

1. Вариативность длительности пауз (EER = 0.383)
2. Изменчивость громкости (EER = 0.431)
3. Средняя скорость изменения спектра (EER = 0.454)
4. Средняя длительность произнесения (EER = 0.461, инвертированный)
5. Количество речевых фрагментов в секунду (EER = 0.463, инвертированный)

**Валидация**: 5-fold стратифицированная кросс-валидация

**Обучающая выборка**:

- 872 образца (436 Real + 436 Fake)
- Сбалансированные классы (50%/50%)

### Часть 4: Сравнение TTS-систем

**Анализируемые системы**:

- **FastPitch-HiFiGAN** — двухступенчатый синтез (mel-спектрограмма → вокодер)
- **VITS** — end-to-end модель с вариационным подходом

**Задачи**:

1. Анализ Natural vs FastPitch
2. Анализ Natural vs VITS
3. Сравнение акустических "сигнатур" систем
4. Кросс-тестирование (обучение на одной системе, тест на другой)

**Выборка для сравнения**:

- 1428 образцов (476 × 3 типа)
- Триплеты: каждая фраза представлена в 3 версиях (Real, FastPitch, VITS)

---

## Результаты

### Одиночные признаки

| Признак | EER | Различие Real/Fake |
|---------|-----|-------------------|
| Вариативность длительности пауз | **38.3%** | +14.0% |
| Изменчивость громкости | 43.1% | +3.6% |
| Средняя скорость изменения спектра | 45.4% | +1.7% |
| Средняя длительность пауз | 46.6% | +4.5% |
| Средняя высота голоса | 52.3% | -0.2% |

**Вывод**: Одиночные признаки слабые (лучший EER = 38.3%)

### Инверсионный эксперимент

**Признаки с EER > 50%** (7 из 13):

| Признак | EER до | EER после | Улучшение |
|---------|--------|-----------|-----------|
| Средняя длительность произнесения | 53.9% | 46.1% | +7.8% |
- Модели "осторожны" с Real (recall 97-98%), но часто пропускают Fake (recall 56-62%)
